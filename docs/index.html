<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Scrape the ECOS Website, http://ecos.fws.gov &bull; ecosscraper</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet"><script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ecosscraper</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="reference/ecosscraper.html">Intro</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jacob-ogre/ecosscraper/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    <div id="ecosscraper" class="section level1">
<div class="page-header"><h1 class="hasAnchor"><a href="#ecosscraper" class="anchor"> </a>ecosscraper</h1></div>
<p>An R package to scrape the U.S. Fish and Wildlife Service&rsquo;s ECOS website.</p>
<div id="early-version" class="section level2">
<h2 class="hasAnchor">
<a href="#early-version" class="anchor"> </a>Early version</h2>
<p>This early version package currently has functions for:</p>
<ul><li>getting a table of listed, candidate, and proposed species, to make links to each species&rsquo; ECOS page</li>
<li>getting all of the links from each species&rsquo; ECOS page (and cleaning out the &lsquo;silly&rsquo; links)</li>
<li>filtering the set of links to documents available for a species</li>
<li>downloading documents</li>
<li>scraping tables on section 10 agreements (e.g., Habitat Conservation Plans)</li>
</ul></div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"> </a>Usage</h2>
<p>Install using <code>devtools</code>, i.e.,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"jacob-ogre/ecosscraper"</span>)</code></pre></div>
<p>We&rsquo;ve tried to make the API as consistent as possible. Most functions that will be of direct use have <code>get_</code> as the prefix; they simply get the target to return as an R object. Most but not all functions take a URL as the primary argument. Many function have a <code>verbose</code> parameter, and with one exception (because it calls other functions that are verbose by default), the default is <code>TRUE</code>.</p>
<p>To get all of the links from the ECOS page of a single species using the species&rsquo; scientific name (which must match the name recorded in ECOS),</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">urls &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_species_url.html">get_species_url</a></span>(<span class="st">"Gila purpurea"</span>) %&gt;%<span class="st"> </span><span class="kw"><a href="reference/get_species_links.html">get_species_links</a></span>()</code></pre></div>
<p>To scrape the tables on a species&rsquo; ECOS page, which will (usually) include a date for the linked resource (e.g., PDF) and other information,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tabs &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_species_url.html">get_species_url</a></span>(<span class="st">"Gila purpurea"</span>) %&gt;%<span class="st"> </span><span class="kw"><a href="reference/get_species_tables.html">get_species_tables</a></span>()</code></pre></div>
<p>There are also helper functions to extract data for particular types of documents, such as five-year reviews:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">five_yr &lt;-<span class="st"> </span><span class="kw"><a href="reference/get_species_url.html">get_species_url</a></span>(<span class="st">"Gila purpurea"</span>) %&gt;%<span class="st"> </span>
<span class="st">             </span><span class="kw"><a href="reference/get_species_links.html">get_species_links</a></span>() %&gt;%
<span class="st">             </span><span class="kw"><a href="reference/get_5yrev_links.html">get_5yrev_links</a></span>()</code></pre></div>
<p>Another function that might get considerable use is <code>download_document</code>, which writes the requested document (PDFs) to file,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">result &lt;-<span class="st"> </span><span class="kw"><a href="reference/download_document.html">download_document</a></span>(<span class="st">"http://ecos.fws.gov/docs/five_year_review/doc3847.pdf"</span>, <span class="st">"~/Downloads"</span>)</code></pre></div>
</div>
<div id="updating" class="section level2">
<h2 class="hasAnchor">
<a href="#updating" class="anchor"> </a>Updating</h2>
<p>The package includes one dataset, the table of threatened, endangered, candidate, and proposed species (<code>TECP_table</code>) using a search from <a href="http://ecos.fws.gov/ecp0/reports/ad-hoc-species-report-input">here</a>. The built in TECP_table was scraped 30 Nov 2016, but the content of ECOS can change at any time. The package scrapes the report page <code>.onAttach</code> so that the newest data is available for each session. If ECOS can&rsquo;t be reached, then the built-in TECP_table is used. Alternatively, <code>TECP_table &lt;- get_TECP_table()</code> may be used to try updating mid-session.</p>
<p>Checking for new links across all listed species can take a bit of time using defaults: the main page-getter will pause for 0.5-3 seconds by default, so as to not hammer the FWS server too much. (Checking for updates for a single species is quick.) We are using <code>ecosscraper</code> to set up a <code>cron</code> job that checks all species&rsquo; pages on a weekly basis; the script and <code>cron</code> settings will be added to this repo in the future.</p>
</div>
<div id="bugs" class="section level2">
<h2 class="hasAnchor">
<a href="#bugs" class="anchor"> </a>Bugs</h2>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"> </a>Contributing</h2>
<p>Interested in helping improve <code>ecosscraper</code>? <a href="mailto:esa@defenders.org">Get in touch with us</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3" id="sidebar">
    <h2>License</h2>
<p><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file <a href="LICENSE">LICENSE</a></p>
<h2>Developers</h2><ul class="list-unstyled"><li>Jacob Malcom <br><small class="roles"> Author, maintainer </small> </li>
</ul></div>
</div>


      <footer><div class="copyright">
  <p>Developed by Jacob Malcom.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
